<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<title>Тестовое задание для PHP-разработчика</title>
</head>
<body>
	<div class="container">
		<h1 class="text-center">Тестовое задание для PHP-разработчика</h1>
		<p class="bg-success" style="padding: 15px;">
			<strong>Вопрос №1.</strong> Имеется интернет-магазин с ассортиментом более 100,000 позиций и посещаемостью 5,000 визитов/сутки. Сайт медленно загружается. Какие методы диагностики необходимо использовать для выявления причин? Описать подробно последовательность действий, которые помогут решить имеющуюся проблему на сайте?
		</p>
		<p>
			В данном задании я привел примеры того, какие действия следует произвести, чтобы обнаружить проблему, а также меры, которые нужно предпринять перед сдачей самого проекта. Приоритет действий можно отсортировать по затраченному времени: то есть сначала выполнить действия, которые требуют немного времени. Я условно разбил все действия на соответствующие сферы:
		</p>
		<div class="row">
			<div class="col-md-4">
				<img class="img-responsive" src="http://www.hardware.zp.ua/cage_blade_server_hp_8bl460c_4bl480c.gif" alt="">
			</div>
			<div class="col-md-8">
				<h5>Конфигурация сервера/CMS:</h5>
				<ul>
					<li>Проверить, включено ли сжатие на сторое сервера (для Apache это <em>mod_deflate</em>).</li>
					<li>Средставми CMS определить проблемные места (общее кол-во запросов в БД, время генерации блоков на странице и прочее).</li>
					<li>Узнать, включено ли кеширование.</li>
				</ul>
			</div>
		</div>
		<div class="row">
			<div class="col-md-8">
				<h5>Backend:</h5>
				<ul>
					<li>Проверить запросы на проблемных страницах, возможно идет очень большая выборка из БД, оптимизировать эти запросы. Если страница очень большая, то необходимо делать новые запросы по необходимости, например подгужать товары при скроле. Или если товары из другой категории (например сопутствующие товары находятся в самом низу), то делать запросы опять же только при скроле пользователем.</li>
					<li>Отключать неиспользуемые функции на страницах (наприер, в <em>result_modifier.php</em> для 1C-Bitrix или <em>functions.php</em> для WordPress).</li>
					<li>Сделать рефакторинг кода, заменить медленные конструкции (например, конструкция if { ... } else { ... } работает быстрее чем switch() { ... }).</li>
					<li>Использовать один сложный запрос к БД, чем несколько простых.</li>
					<li>Включить логирование на сервере, изучить их.</li>
					<li>Включить просмотр ошибок PHP.</li>
				</ul>
			</div>
			<div class="col-md-4">
				<img class="img-responsive" src="http://21designs.com.au/wp-content/uploads/mysql-icon.png" alt="">
			</div>
		</div>
		<div class="row">
			<div class="col-md-4">
				<img class="img-responsive" src="http://2.bp.blogspot.com/-r4oPIvDqY8E/VZZHJzSCCAI/AAAAAAAAAOA/EW-Oxpl2ApU/s1600/web-trifecta_html5_css3_js-strict.png" alt="">
			</div>
			<div class="col-md-8">
				<h5>Frontend:</h5>
				<ul>
					<li>
						Проверить сайт средствами <em>Google Pagespeed Insights</em>, который включает в себя:
						<ul>
							<li>Находятся ли файлы со стилями и JavaScript кодом в минифицированном и сжатом виде.</li>
							<li>Были ли сжаты картинки.</li>
							<li>Все необходимые файлы стилей и JavaScript кода должны быть подключены в конце документа.</li>
						</ul>
					</li>
					<li>При помощи встроенных DevTools инструментов проверить наличие ошибок в подключении/недоступности файлов, просмотреть количество запросов к файлам документа и скорость их загрузки.</li>
					<li>Проверить возможность замены мелких иконок на спрайты или иконочный шрифт.</li>
					<li>Проверить откуда происходит загрузка файлов (с нашего сервера или с серверов CDN).</li>
					<li>Сделать рефакторинг когда (например убрать универсальный селектор "*" из файла стилей или проверить валидность JavaScript кода <em>Linter'ом</em>).</li>
					<li>Все сторонние скрипты и библиотеки подключать только в конце страницы (Яндекс.Метрика и прочие).</li>
				</ul>
			</div>
		</div>
		<br>
		<br>
		<br>
		<p class="bg-success" style="padding: 15px;">
			<strong>Вопрос №2.</strong> Имеется каталог изображений на хостинге, содержащий 500,000 файлов в одной директории, общим объемом 200гб. Необходимо делать выборку изображений по диапазону даты изменения файлов. Интерфейс должен содержать форму с двумя полями: дата изменения с, дата изменения по. Результаты должны возвращаться после запроса в виде списка полных путей до файлов не более чем за 15сек. Рассмотрим, что за один запрос обычно возвращается не более 10,000 файлов. При реализации могут быть использованы любые веб-технологии (PHP, MySQL, JS, CSS, HTML). Описать механизм решения задачи и дать техническое обоснование выбранного решения. Чем подробнее будет раскрыт каждый шаг, тем больше шансов будет пройти собеседование.
		</p>
		<p>
			Данная задача решается методом перебора/добавления разных путей решения. Если учитывать, что вся информация о файлах содержится в БД, то:
		</p>
		<div class="row">
			<div class="col-md-4">
				<br>
				<em>Метод прямой сортировки:</em>
				<img class="img-responsive" src="https://habrastorage.org/getpro/habr/post_images/7ae/81a/1aa/7ae81a1aa491bd3514e5dabdc68028ae.gif" alt="">
				<br>
				<br>
				<em>Пузырьковая сортировка:</em>
				<img class="img-responsive" src="https://habrastorage.org/getpro/habr/post_images/187/5a3/929/1875a3929dd14c8ea5ff4ccc3d0db9bd.gif" alt="">
			</div>
			<div class="col-md-8">
				<ul>
					<li>Так как выборка будет работать не один раз, а многократно, то необходимо привести таблицу к какому-либо состоянию "по-умолчанию", а именно добавить индексное поле в виде ключа (например <em>2016-03-04</em>, то есть перевернутая дата).</li>
					<li>Таким образом в БД будут записи <em>20120303123456789</em> или <em>20160912123456789</em> (дата + время), по которым можно будет легко отсекать самые ранние (в данном случае фото, измененные в 2012 году) и поздние (2016 год).</li>
					<li>Также стоит посмотреть на сами методы сортировки, то есть например сортировка <em>"пузырькового типа"</em> работает намного быстрее, чем обычная сортировка.</li>
					<li>Следует также следить за переполнение памяти: вовремя освобождать саму память, работать с массивом правильно (например не заполнять первую и 10000-ную ячейку, оставляя пустыми остальные 9998).</li>
				</ul>
			</div>
		</div>
		<div class="row">
			<div class="col-md-4"></div>
			<div class="col-md-8">

			</div>
		</div>

		<p class="bg-success" style="padding: 15px;">
			<strong>Вопрос №3.</strong> Имеется список из 11 сайтов. Необходимо спарсить товары с указанных сайтов, привести к единому виду и записать в одну таблицу базы данных MySQL. Категории товаров аналогично должны быть приведены к единому виду с сохранением иерархии, а затем записаны в отдельную таблицу базы данных. Могут быть использованы дополнительные таблицы при необходимости (например для записи связей или технических характеристик продукции). Описать общую стратегию выполнения данной задачи, а также дать детальный разбор получения информации с каждого сайта.
		</p>
		<ul>
			<li><a href="http://sakurafilter.com">http://sakurafilter.com</a></li>
			<li><a href="https://catalog.donaldson.com/">https://catalog.donaldson.com/</a></li>
			<li><a href="https://catalog.mann-filter.com/EU/rus">https://catalog.mann-filter.com/EU/rus</a></li>
			<li><a href="http://catalog.baldwinfilter.com/">http://catalog.baldwinfilter.com/</a></li>
			<li><a href="http://shop.sf-filter.de/vergleichsliste.aspx">http://shop.sf-filter.de/vergleichsliste.aspx</a></li>
			<li><a href="https://hifi-filter.com/en/catalog/recherche-equivalence.html">https://hifi-filter.com/en/catalog/recherche-equivalence.html</a></li>
			<li><a href="http://www.filfilter.com.tr/en/oc-muadil-urun-ref.php">http://www.filfilter.com.tr/en/oc-muadil-urun-ref.php</a></li>
			<li><a href="http://tsn.tsitron.ru/tsn/catalogue/?search_text=9.8.34&criterion_search=1&coincidence=1">http://tsn.tsitron.ru/tsn/catalogue/?search_text=9.8.34&criterion_search=1&coincidence=1</a></li>
			<li><a href="http://wixeurope.com/cross-list,1714.html">http://wixeurope.com/cross-list,1714.html</a></li>
			<li><a href="http://ows-cdn.tecdoc.net/stellox/home.jsp?server=4&time=21/9/2016-9:34:7#9f0a7faf39ddd73a2e22f14a94f205fa">http://ows-cdn.tecdoc.net/stellox/home.jsp?server=4&time=21/9/2016-9:34:7#9f0a7faf39ddd73a2e22f14a94f205fa</a></li>
			<li><a href="https://catalog.cumminsfiltration.com/catalog/CatalogSearch.do">https://catalog.cumminsfiltration.com/catalog/CatalogSearch.do</a></li>
		</ul>
		<p>Перед созданием парсера необходмо изучить сайты-доноры и учесть несколько нюансов при написании самого парсера:</p>
		<ul>
			<li>Необходимо изучить сайты на предмет наличия URL товаров в карте сайта (если пути до товаров жестко прописаны в <em>sitemap.xml</em>).</li>
			<li>Используя регулярные выражения и поиск по подстроке создать список страниц-доноров, с которых будем "грабить" информацию (в том числе при помощи GET и POST запросов).</li>
		</ul>
		<p>Общая стратегия: при парсинге товаров я бы использовал таблицу, ключом в которой выбрал бы номер детали (артикул). Также нужна таблица с перечисленными группами (легковые, грузовые и прочие), списком производителей этих товаров.</p>
		<div class="row">
			<div class="col-md-4">
				<img class="img-responsive" src="http://www.sakurafilter.com/css/sakura/images/sakura_logo2.png" alt="">
				<em>http://sakurafilter.com</em>
			</div>
			<div class="col-md-8">
				<p>На данном сайте возможен поиск:</p>
				<ul>
					<li>по номеру детали</li>
					<li>поиск изделия по региону</li>
					<li>поиск по размерам и/или типу фильтра</li>
					<li>а также список устаревших/заменяемых продуктов</li>
				</ul>
				<p>При помощи парсинга из SELECT можно составить список тех страниц, которые необходимо будет парсить. Сама форма отправляет данные методом POST.</p>
				<p>Например, при поиске фильтров по размерам/типу фильтров будут использованы поля <em>"filter_type"</em>, <em>"shape"</em> и <em>"type_detail"</em>.</p>
			</div>
		</div>

		<div class="row">
			<div class="col-md-8">
				<p>Сайт по данному URL недоступен, но работает домен первого уровня (<a href="donaldson.com">donaldson.com</a>)</p>
				<p>На данном сайте есть страница (<a href="http://www.emea.donaldson.com/en/about/products/index.html">http://www.emea.donaldson.com/en/about/products/index.html</a>) с полным перечнем групп товаров. Нас, вероятно, будет интересовать группа "Air Filters". Если проваливаться в саму группу, то информации по товарам, как и самих товаров, очень мало. Вся информация хранится в виде PDF-файлов.</p>
			</div>
			<div class="col-md-4 bg-primary" style="padding: 15px">
				<img class="img-responsive" src="http://emea.donaldson.com/ru/images/homeLogo.gif" alt="">
				<em>https://catalog.donaldson.com/<br>(недоступен, но доступен домен первого уровня)</em>
			</div>
		</div>

		<div class="row">
			<div class="col-md-4">
				<img class="img-responsive" src="https://catalog.mann-filter.com/files/imagesVariablePath/mann-filter-logo.jpg" alt="">
				<em>https://catalog.mann-filter.com</em>
			</div>
			<div class="col-md-8">
				<p>На данном сайте возможен поиск:</p>
				<ul>
					<li>
						по транспортных средств:
						<ul>
							<li>Легковые автомобили + автомобили-фургоны</li>
							<li>Грузовые автомобили и автобусы</li>
							<li>Машины для внедорожного применения</li>
							<li>Мотоциклы</li>
						</ul>
					</li>
				</ul>
				<p>Есть также поиск по продуктам и сравнительныи номерам. Зная, что у каждого товара (в нашем случае фильтров) есть артикул, можем сделать поиск по артиклу, либо сделать поиск по группе товаров.</p>
				<p>Для каждой группы есть свой URL:</p>
				<ul>
					<li>https://catalog.mann-filter.com/EU/rus/vehicle/MANN-FILTER/Katalog/Europa/Транспортные%20средства/</li>
					<li>https://catalog.mann-filter.com/EU/rus/vehicle/MANN-FILTER/Katalog/Europa/Грузовые%20автомобили%20%2B%20автобусы/</li>
					<li>https://catalog.mann-filter.com/EU/rus/vehicle/MANN-FILTER/Katalog/Europa/Машины%20для%20внедорожного%20применения/</li>
					<li>https://catalog.mann-filter.com/EU/rus/vehicle/MANN-FILTER/Katalog/Europa/Мотоциклы/</li>
				</ul>
				<p>На каждой такой странице есть SELECT с выбором производителя. Изучив внутрениие страницы можно получить методом подстроки все возможные варианты страниц, например:</p>
				<ul>
					<li>https://catalog.mann-filter.com/EU/rus/vehicle/MANN-FILTER/Katalog/Europa/ - общая страница</li>
					<li>Мотоциклы/ - Группа ТС</li>
					<li>APRILIA/ - Производитель</li>
					<li>125/ - Модельный ряд</li>
				</ul>
			</div>
		</div>

		<div class="row">
			<div class="col-md-8">
				<p>Если перейти на страницу http://catalog.baldwinfilter.com/startproductguide.html, выбрать в меню: "Catalog Information" -> "Size Chart Search" и далее выбрать "Английское измерение", то откроется поиск по фильтрам.</p>
				<p>Данные подгружаются методом AJAX, поэтому необходимо будет делать соответствующие запросы. Также есть поиск по номеру и другим критериям товаров.</p>
			</div>
			<div class="col-md-4" style="padding: 15px">
				<img class="img-responsive" src="http://catalog.baldwinfilter.com/Images1/BFBrandDB0707.gif" alt="">
				<em>http://catalog.baldwinfilter.com/</em>
			</div>
		</div>

		<div class="row">
			<div class="col-md-4">
				<img class="img-responsive" src="http://shop.sf-filter.de/images/SF-Filter-Logo.jpg" alt="">
				<em>http://shop.sf-filter.de/vergleichsliste.aspx</em>
			</div>
			<div class="col-md-8">
				<p>На данном сайте все нужные нам товары также разбиты по группам, которые находятся по разным URL:</p>
				<ul>
					<li>http://shop.sf-filter.de/mobilefilterselect.aspx?Katalog=PW&Titel=Automobile - Filters for Automobile</li>
					<li>http://shop.sf-filter.de/mobilefilterselect.aspx?Katalog=LKW&Titel=Trucks - Filters for Trucks и так далее</li>
				</ul>
				<p>На каждой странице есть форма: "Производитель", "Модель", "Год, двигатель".</p>
				<p>Подгрузка происходит также методом AJAX, что даем направление парсить поочередно элементы первой формы и передавать их в запросе.</p>
				<p>В результате выходит список найденных товаров, который также содержит в себе фотографию товара.</p>
			</div>
		</div>


	</div>
</body>
</html>
